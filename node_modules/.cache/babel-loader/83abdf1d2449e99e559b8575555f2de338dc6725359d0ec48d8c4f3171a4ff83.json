{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport { useSessionStore } from '../stores/session.store.js';\nimport { useGlobalStore } from '../stores/global.store.js';\nimport { util } from './util.js';\nexport const useApi = function (vueApp) {\n  const sessionStore = useSessionStore();\n  const globalStore = useGlobalStore();\n  const api = {\n    post: async function (args) {\n      globalStore.loader = true;\n      await axios.post(args.url, args.data, {\n        headers: {\n          'Authorization': \"Bearer \" + sessionStore.token\n        }\n      }).then(resp => {\n        console.log('POST: url :' + args.url);\n        console.log(resp);\n        //resp= resp.map((r)=> { return r.data});\n        args.success(resp);\n        globalStore.loader = false;\n      }).catch(err => {\n        try {\n          if ('error' in err.response.data) {\n            args.error(err.response.data);\n          } else {\n            args.error(null);\n          }\n        } catch (e) {\n          args.error(null);\n        }\n        globalStore.loader = false;\n      });\n    },\n    delete: async function (args) {\n      globalStore.loader = true;\n      await axios.delete(args.url, {\n        headers: {\n          'Authorization': \"Bearer \" + sessionStore.token\n        }\n      }).then(resp => {\n        console.log('DELETE: url :' + args.url);\n        console.log(resp);\n        //resp= resp.map((r)=> { return r.data});\n        args.success(resp);\n        globalStore.loader = false;\n      }).catch(err => {\n        console.log(err);\n        //if ('error' in args) {\n        args.error(err);\n        globalStore.loader = false;\n        //}\n        //$q.loading.hide();\n      });\n    },\n\n    patch: async function (args) {\n      globalStore.loader = true;\n      await axios.patch(args.url, args.data, {\n        headers: {\n          'Authorization': \"Bearer \" + sessionStore.token\n        }\n      }).then(resp => {\n        console.log('PATCH: url :' + args.url);\n        console.log(resp);\n        //resp= resp.map((r)=> { return r.data});\n        args.success(resp);\n        globalStore.loader = false;\n      }).catch(err => {\n        console.log(err);\n        //this.state.ts.loader.show = false;\n        //if ('error' in args) {\n\n        try {\n          if ('error' in err.response.data) {\n            args.error(err.response.data);\n          } else {\n            args.error(null);\n          }\n        } catch (e) {\n          args.error(null);\n        }\n        globalStore.loader = false;\n        //}\n        //$q.loading.hide();\n      });\n    },\n\n    get: async function (args) {\n      globalStore.loader = true;\n      let promises = [];\n      for (let i = 0; i < args.url.length; i++) {\n        var params = args.url[i][1];\n        console.log(params);\n        if (util.isNull(params)) {\n          params = {};\n        }\n        // Si viene _filter_ lo convierto con JSON.stringify()\n        if ('_filter_' in params) {\n          params._filter_ = JSON.stringify(params._filter_);\n        }\n        promises.push(axios.get(args.url[i][0], {\n          params: params,\n          headers: {\n            'Authorization': \"Bearer \" + sessionStore.token\n          }\n        }));\n      }\n\n      //$q.loading.show();\n\n      //$q.loading.show();\n      await axios.all(promises).then(axios.spread((...resp) => {\n        //resp= resp.map((r)=> { return r.data});\n        args.success(...resp);\n        globalStore.loader = false;\n      })).catch(err => {\n        //this.state.ts.loader.show = false;\n        //console.log(err);\n        //if ('error' in args) {\n        args.error(err);\n        globalStore.loader = false;\n        //} \n        //$q.loading.hide();\n      });\n    }\n  };\n\n  return api;\n};","map":{"version":3,"names":["axios","useSessionStore","useGlobalStore","util","useApi","vueApp","sessionStore","globalStore","api","post","args","loader","url","data","headers","token","then","resp","console","log","success","catch","err","response","error","e","delete","patch","get","promises","i","length","params","isNull","_filter_","JSON","stringify","push","all","spread"],"sources":["/opt/rdx-vitrina-front/src/helpers/api.js"],"sourcesContent":["import axios from 'axios';\n\n\nimport { useSessionStore } from '../stores/session.store.js';\nimport { useGlobalStore } from '../stores/global.store.js';\nimport { util } from './util.js';\n\n\n\nexport const useApi = function(vueApp) {\n\n  const sessionStore  = useSessionStore();\n  const globalStore  = useGlobalStore();\n        \n  const api = {\n    post: async function(args) {\n      globalStore.loader = true;\n      await axios.post(args.url,args.data,\n                      {headers: {'Authorization': \"Bearer \"+sessionStore.token}})\n           .then( (resp) => {\n               console.log('POST: url :'+args.url);\n               console.log(resp);\n               //resp= resp.map((r)=> { return r.data});\n               args.success(resp);\n               globalStore.loader = false; \n           })\n           .catch( (err)  => {\n               try  {\n                  if ('error' in err.response.data) {\n                     args.error(err.response.data);\n                  }\n                  else {\n                     args.error(null);\n                  }\n               }\n               catch (e)  { args.error(null);  }\n               globalStore.loader = false; \n           }); \n       \n    },\n    \n    delete: async function(args) {\n      globalStore.loader = true; \n      await axios.delete(args.url,\n                      {headers: {'Authorization': \"Bearer \"+sessionStore.token}})\n           .then( (resp) => {\n               console.log('DELETE: url :'+args.url);\n               console.log(resp);\n               //resp= resp.map((r)=> { return r.data});\n               args.success(resp);\n               globalStore.loader = false; \n           })\n           .catch( (err)  => {\n               console.log(err);\n               //if ('error' in args) {\n                  args.error(err);\n                  globalStore.loader = false; \n               //}\n               //$q.loading.hide();\n           }); \n       \n    },\n        \n    patch: async function(args) {\n      globalStore.loader = true; \n      await axios.patch(args.url,args.data,\n                      {headers: {'Authorization': \"Bearer \"+sessionStore.token}})\n           .then( (resp) => {\n               console.log('PATCH: url :'+args.url);\n               console.log(resp);\n               //resp= resp.map((r)=> { return r.data});\n               args.success(resp);\n               globalStore.loader = false; \n               \n           })\n           .catch( (err)  => {\n               console.log(err);\n               //this.state.ts.loader.show = false;\n               //if ('error' in args) {\n                  \n                  try  {\n                    if ('error' in err.response.data) {\n                       args.error(err.response.data);\n                    }\n                    else {\n                       args.error(null);\n                    }\n                  }\n                  catch (e)  { args.error(null);  }\n                  globalStore.loader = false; \n               //}\n               //$q.loading.hide();\n           }); \n       \n    },\n    get: async function(args) {\n           globalStore.loader = true; \n           let promises = [];\n           for (let i=0; i < args.url.length; i++ ) {\n                var params = args.url[i][1];\n                console.log(params);\n                if (util.isNull(params)) {\n                  params={};\n                }\n               // Si viene _filter_ lo convierto con JSON.stringify()\n               if ('_filter_' in params) {\n                 params._filter_ = JSON.stringify(params._filter_)\n               }  \n               promises.push(axios.get( args.url[i][0], \n                               { params: params,\n                                 headers: {'Authorization': \"Bearer \"+sessionStore.token},\n                               } \n                             )\n                ); \n           }\n           \n           \n           \n           //$q.loading.show();\n\n           \n           //$q.loading.show();\n           await axios.all(promises)\n           .then(axios.spread( (...resp) => {\n               //resp= resp.map((r)=> { return r.data});\n               args.success(...resp);\n               globalStore.loader = false; \n           }))\n           .catch( (err)  => {\n               //this.state.ts.loader.show = false;\n               //console.log(err);\n               //if ('error' in args) {\n                  args.error(err);\n                  globalStore.loader = false; \n               //} \n               //$q.loading.hide();\n           });           \n           \n                 \n    }  \n  }\n  \n  return api;\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}